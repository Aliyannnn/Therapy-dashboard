{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/My%20Pc/Downloads/therapy-dashboard-improved-v2%20%281%29/therapy-dashboard-improved-v2/lib/api.ts"],"sourcesContent":["import axios from 'axios';\n\n\n\n// API Base URL - Update this to your backend URL\nexport const API_BASE_URL = process.env.NEXT_PUBLIC_API_URL || 'http://localhost:8000';\n\nexport const apiClient = axios.create({\n  baseURL: API_BASE_URL,\n  headers: {\n    'Content-Type': 'application/json',\n    'ngrok-skip-browser-warning': 'true', // ← ADD THIS\n  },\n});\n\n// Request interceptor to add auth token\napiClient.interceptors.request.use(\n  (config) => {\n    const token = localStorage.getItem('auth_token');\n    if (token) {\n      config.headers.Authorization = `Bearer ${token}`;\n    }\n    return config;\n  },\n  (error) => {\n    return Promise.reject(error);\n  }\n);\n\n// Response interceptor to handle errors\napiClient.interceptors.response.use(\n  (response) => response,\n  (error) => {\n    if (error.response?.status === 401) {\n      // Clear token and redirect to login\n      localStorage.removeItem('auth_token');\n      localStorage.removeItem('user_type');\n      window.location.href = '/login';\n    }\n    return Promise.reject(error);\n  }\n);\n\n// API endpoints\nexport const API_ENDPOINTS = {\n  // Admin endpoints\n  ADMIN_VERIFY_CODE: '/dashboard/api/v1/dashboard/admin/verify-code',\n  ADMIN_LOGIN: '/dashboard/api/v1/dashboard/admin/login',\n  ADMIN_CREATE_USER: '/dashboard/api/v1/dashboard/admin/users/create',\n  ADMIN_GET_USERS: '/dashboard/api/v1/dashboard/admin/users', // LEGACY: Dashboard users only\n  ADMIN_GET_ALL_USERS: '/dashboard/api/v1/dashboard/admin/all-users', // NEW: All users with filter\n  ADMIN_GET_USER: (userId: string) => `/dashboard/api/v1/dashboard/admin/users/${userId}`,\n  ADMIN_UPDATE_USER: (userId: string) => `/dashboard/api/v1/dashboard/admin/users/${userId}`,\n  ADMIN_DELETE_USER: (userId: string) => `/dashboard/api/v1/dashboard/admin/users/${userId}`,\n  ADMIN_REACTIVATE_USER: (userId: string) => `/dashboard/api/v1/dashboard/admin/users/${userId}/reactivate`, // NEW\n  ADMIN_STATS: '/dashboard/api/v1/dashboard/admin/stats',\n  ADMIN_ACTIVITY: '/dashboard/api/v1/dashboard/admin/activity',\n  ADMIN_ALL_SESSIONS: '/dashboard/api/v1/dashboard/admin/sessions',\n  ADMIN_USER_HISTORY: (userId: string) => `/dashboard/api/v1/dashboard/admin/users/${userId}/history`,\n\n  // User endpoints\n  USER_LOGIN: '/dashboard/api/v1/dashboard/user/login',\n  \n  // Session endpoints\n  SESSION_CREATE: '/dashboard/api/v1/dashboard/sessions/create',\n  SESSION_MY_SESSIONS: '/dashboard/api/v1/dashboard/sessions/my-sessions',\n  SESSION_ANALYZE: (sessionId: string) => `/dashboard/api/v1/dashboard/sessions/${sessionId}/analyze`,\n  \n  // Chat endpoints\n  CHAT_MESSAGE: '/dashboard/api/v1/dashboard/chat/message',\n  CHAT_AUDIO: '/dashboard/api/v1/dashboard/chat/audio',\n  \n  // Report endpoints\n  REPORT_GENERATE: (sessionId: string) => `/dashboard/api/v1/dashboard/sessions/${sessionId}/report`,\n  REPORT_DOWNLOAD: (sessionId: string) => `/dashboard/api/v1/dashboard/reports/${sessionId}/download`,\n};\n\n// Auth helpers\nexport const saveAuthToken = (token: string, userType: 'admin' | 'user') => {\n  localStorage.setItem('auth_token', token);\n  localStorage.setItem('user_type', userType);\n};\n\nexport const updateUser = async (userId: string, data: any) => {\n  return apiClient.put(`/dashboard/api/v1/dashboard/admin/users/${userId}`, data);\n};\n\nexport const getAuthToken = () => {\n  return localStorage.getItem('auth_token');\n};\n\nexport const getUserType = (): 'admin' | 'user' | null => {\n  return localStorage.getItem('user_type') as 'admin' | 'user' | null;\n};\n\nexport const clearAuth = () => {\n  localStorage.removeItem('auth_token');\n  localStorage.removeItem('user_type');\n};\n\nexport const isAuthenticated = () => {\n  return !!getAuthToken();\n};\n\n\n/**\n * Download session report as PDF\n * @param sessionId - The session ID to download report for\n * @returns Promise with blob data\n */\nexport const downloadSessionReport = async (sessionId: string) => {\n  return apiClient.get(API_ENDPOINTS.REPORT_DOWNLOAD(sessionId), {\n    responseType: 'blob',\n  });\n};\n\n/**\n * Helper function to trigger browser download of a blob\n * @param blob - The blob data to download\n * @param filename - The filename to save as\n */\nexport const triggerBrowserDownload = (blob: Blob, filename: string) => {\n  const url = window.URL.createObjectURL(blob);\n  const link = document.createElement('a');\n  link.href = url;\n  link.setAttribute('download', filename);\n  document.body.appendChild(link);\n  link.click();\n  link.remove();\n  window.URL.revokeObjectURL(url);\n};\n\n/**\n * Generate report for a session\n * @param sessionId - The session ID to generate report for\n */\nexport const generateSessionReport = async (sessionId: string) => {\n  return apiClient.post(API_ENDPOINTS.REPORT_GENERATE(sessionId));\n};\n\n// ═══════════════════════════════════════════════════════════════════════════\n// API Helper Functions - Sessions\n// ═══════════════════════════════════════════════════════════════════════════\n\n/**\n * Get all sessions (admin only)\n * @param status - Filter by status\n */\nexport const getAllSessions = async (status?: string) => {\n  const params: any = {};\n  if (status) params.status = status;\n  return apiClient.get(API_ENDPOINTS.ADMIN_ALL_SESSIONS, { params });\n};\n\n/**\n * Get user's own sessions\n */\nexport const getMySessions = async () => {\n  return apiClient.get(API_ENDPOINTS.SESSION_MY_SESSIONS);\n};\n\n/**\n * Create a new session\n */\nexport const createSession = async (data: { session_type: 'web' | 'vr' }) => {\n  return apiClient.post(API_ENDPOINTS.SESSION_CREATE, data);\n};\n\n/**\n * Analyze a session\n * @param sessionId - The session ID to analyze\n */\nexport const analyzeSession = async (sessionId: string) => {\n  return apiClient.post(API_ENDPOINTS.SESSION_ANALYZE(sessionId));\n};\n\n/**\n * Get user activity history (admin only)\n * @param userId - The user ID to get history for\n */\nexport const getUserHistory = async (userId: string) => {\n  return apiClient.get(API_ENDPOINTS.ADMIN_USER_HISTORY(userId));\n};\n\n// ═══════════════════════════════════════════════════════════════════════════\n// API Helper Functions - Admin Stats & Activity\n// ═══════════════════════════════════════════════════════════════════════════\n\n/**\n * Get admin dashboard statistics\n */\nexport const getAdminStats = async () => {\n  return apiClient.get(API_ENDPOINTS.ADMIN_STATS);\n};\n\n/**\n * Get recent activity log\n */\nexport const getAdminActivity = async () => {\n  return apiClient.get(API_ENDPOINTS.ADMIN_ACTIVITY);\n};\n\n// ═══════════════════════════════════════════════════════════════════════════\n// API Helper Functions - User Management\n// ═══════════════════════════════════════════════════════════════════════════\n\n/**\n * Get all users (VR + Dashboard) with optional filtering\n * @param skip - Number of users to skip (pagination)\n * @param limit - Maximum users to return\n * @param userType - Filter by user type: 'vr', 'dashboard', or undefined for all\n * @param includeInactive - Include deactivated users\n */\nexport const getAllUsers = async (\n  skip = 0,\n  limit = 100,\n  userType?: 'vr' | 'dashboard',\n  includeInactive = false\n) => {\n  const params = new URLSearchParams({\n    skip: skip.toString(),\n    limit: limit.toString(),\n    include_inactive: includeInactive.toString(),\n  });\n\n  if (userType) {\n    params.append('user_type', userType);\n  }\n\n  return apiClient.get(`${API_ENDPOINTS.ADMIN_GET_ALL_USERS}?${params.toString()}`);\n};\n\n/**\n * LEGACY: Get dashboard users only (kept for backward compatibility)\n */\nexport const getDashboardUsers = async (skip = 0, limit = 100) => {\n  return apiClient.get(`${API_ENDPOINTS.ADMIN_GET_USERS}?skip=${skip}&limit=${limit}`);\n};\n\n/**\n * Get specific user details (works for VR and Dashboard users)\n */\nexport const getUserDetails = async (userId: string) => {\n  return apiClient.get(API_ENDPOINTS.ADMIN_GET_USER(userId));\n};\n\n/**\n * Create new dashboard user\n */\nexport const createDashboardUser = async (data: {\n  name: string;\n  email?: string;\n  phone?: string;\n  notes?: string;\n}) => {\n  return apiClient.post(API_ENDPOINTS.ADMIN_CREATE_USER, data);\n};\n\n/**\n * Update user information (type-aware on backend)\n * For VR users: only name, email, is_active will be updated\n * For Dashboard users: all fields can be updated\n */\nexport const updateUserInfo = async (\n  userId: string,\n  data: {\n    name?: string;\n    email?: string;\n    phone?: string;\n    notes?: string;\n    is_active?: boolean;\n  }\n) => {\n  return apiClient.put(API_ENDPOINTS.ADMIN_UPDATE_USER(userId), data);\n};\n\n/**\n * Deactivate user (soft delete - works for VR and Dashboard users)\n */\nexport const deactivateUser = async (userId: string) => {\n  return apiClient.delete(API_ENDPOINTS.ADMIN_DELETE_USER(userId));\n};\n\n/**\n * Reactivate a deactivated user\n */\nexport const reactivateUser = async (userId: string) => {\n  return apiClient.post(API_ENDPOINTS.ADMIN_REACTIVATE_USER(userId));\n};"],"names":[],"mappings":"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"}},
    {"offset": {"line": 216, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/My%20Pc/Downloads/therapy-dashboard-improved-v2%20%281%29/therapy-dashboard-improved-v2/app/page.tsx"],"sourcesContent":["'use client';\n\nimport { useEffect } from 'react';\nimport { useRouter } from 'next/navigation';\nimport { isAuthenticated, getUserType } from '@/lib/api';\n\nexport default function Home() {\n  const router = useRouter();\n\n  useEffect(() => {\n    if (isAuthenticated()) {\n      const userType = getUserType();\n      if (userType === 'admin') {\n        router.push('/admin/dashboard');\n      } else if (userType === 'user') {\n        router.push('/user/dashboard');\n      } else {\n        router.push('/login');\n      }\n    } else {\n      router.push('/login');\n    }\n  }, [router]);\n\n  return (\n    <div className=\"h-screen w-screen flex items-center justify-center bg-black\">\n      <div className=\"text-white text-xl\">Loading...</div>\n    </div>\n  );\n}\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;;;AAJA;;;;AAMe,SAAS;;IACtB,MAAM,SAAS,IAAA,kJAAS;IAExB,IAAA,0KAAS;0BAAC;YACR,IAAI,IAAA,gIAAe,KAAI;gBACrB,MAAM,WAAW,IAAA,4HAAW;gBAC5B,IAAI,aAAa,SAAS;oBACxB,OAAO,IAAI,CAAC;gBACd,OAAO,IAAI,aAAa,QAAQ;oBAC9B,OAAO,IAAI,CAAC;gBACd,OAAO;oBACL,OAAO,IAAI,CAAC;gBACd;YACF,OAAO;gBACL,OAAO,IAAI,CAAC;YACd;QACF;yBAAG;QAAC;KAAO;IAEX,qBACE,6LAAC;QAAI,WAAU;kBACb,cAAA,6LAAC;YAAI,WAAU;sBAAqB;;;;;;;;;;;AAG1C;GAvBwB;;QACP,kJAAS;;;KADF"}}]
}